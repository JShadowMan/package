CGO编程 - 函数调用
---------------

通过CGO技术我们不仅可以在Go语言中调用C语言函数，也可以将Go语言函数导出为C语言函数。


### Go调用C函数

对于一个启用CGO特性的程序，CGO会构造一个虚拟的C包，通过这个虚拟的C包可以调用C语言函数。

可以正常获取C语言函数的返回值（有的情况下），如果指定C语言函数返回值为`void`则是可以获取到`_Ctype_void{}`类型。

如果需要在C语言函数中返回多值（只支持第二个值为error），这需要在C语言中引入`errno.h`标准库并在需要返回时赋值全局变量`errno`（对于`void`返回值的C函数通用适用）即可实现返回`error`类型的实例`syscall.Errno`。

对于无返回值`void`的C语言函数，在Go中调用时获得的返回类型为`_Ctype_void{}`。在CGO生成的代码中，这个类型对应一个长度为0的字节数组`[0]byte`。


### C调用Go的导出函数

CGO生成的`_cgo_export.h`文件将会包含Go函数导出的相对应的C函数声明。

__注意：如果需要在CGO文件中立即使用Go导出的函数，则不能引用`_cgo_export.h`文件，否则将会导致循环依赖（此时CGO内引用了还未生成的`_cgo_export.h`文件）。__

__当导出C语言接口时，需要保证函数的参数和返回值类型都是C语言友好的，同时返回值不能直接或间接地包含Go语言内存空间的指针。__
